{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue","webpack:///./src/packages/plugins/event.ts","webpack:///./src/packages/utils/defer.ts","webpack:///./src/packages/utils/dialog-service.tsx","webpack:///./src/packages/utils/useModel.tsx","webpack:///./src/packages/visual-editor.utils.ts","webpack:///./src/packages/components/block-resizer/block-resize.tsx","webpack:///./src/packages/visual-editor-block.tsx","webpack:///./src/packages/plugins/keyboard-code.ts","webpack:///./src/packages/plugins/command.plugin.ts","webpack:///./src/packages/visual.command.tsx","webpack:///./src/packages/visual-editor.props.tsx","webpack:///./src/packages/utils/dropdown-service.tsx","webpack:///./src/packages/components/table-prop-editor/table-prop-editor.service.tsx","webpack:///./src/packages/components/table-prop-editor/table-prop-editor.tsx","webpack:///./src/packages/visual-editor-operator.tsx","webpack:///./src/packages/visual-editor.tsx","webpack:///./src/packages/components/number-range/number-range.tsx","webpack:///./src/visual.config.tsx","webpack:///./src/App.vue?dfb6","webpack:///./src/main.ts","webpack:///./src/App.vue?269d"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","class","style","jsonData","config","visualConfig","formData","customProps","JSON","stringify","createEvent","listeners","on","cb","off","index","indexOf","emit","forEach","item","DialogServiceEditType","defer","dfd","promise","Promise","resolve","reject","keyGenerator","count","ServiceComponent","props","option","type","required","setup","ctx","state","editValue","showFlag","methods","service","show","hide","handler","onConfirm","onCancel","assign","proxy","title","default","editType","textarea","rows","footer","onClick","DialogService","ins","el","document","createElement","body","appendChild","app","mount","$$dialog","input","initValue","opt","useModel","emitter","val","modelValue","String","model","createNewBlock","component","left","top","componentKey","adjustPosition","focus","zIndex","width","height","hasResize","createVisualEditorConfig","componentList","componentMap","registry","comp","Direction","VisualProvider","VISUAL_DRAG_PROVIDER","provide","inject","BlockResize","block","dragstart","dragend","startX","startY","startWidth","startHeight","startLeft","startTop","dragging","direction","horizontal","start","vertical","mousedown","e","stopPropagation","addEventListener","mousemove","mouseup","clientX","clientY","moveX","moveY","center","durX","durY","removeEventListener","resize","end","VisualEditorBlock","slots","classes","styles","offsetWidth","offsetHeight","render","slotName","size","keys","reduce","prev","propName","modelName","custom","keyboardCode","16","17","18","8","9","13","27","32","37","38","39","40","46","189","187","48","49","50","51","52","53","54","55","56","57","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","112","113","114","115","116","117","118","119","120","121","122","123","useCommander","current","queue","commandArray","commands","destroyList","command","execute","undo","redo","followQueue","keyboardEvent","onKeydown","activeElement","keyCode","shiftKey","altKey","ctrlKey","metaKey","keyString","keyNames","join","keyboard","Array","isArray","preventDefault","init","queueItem","fn","useVisualCommand","focusData","updateBlocks","dataModel","commander","before","blocks","after","unFocus","this","drag","maxZIndex","pre","Math","max","Infinity","minZIndex","min","dur","abs","newBlock","oldBlock","delete","clear","placeTop","placeBottom","updateBlock","updateModelValue","VisualEditorPropsType","DropdownServiceProvider","DROPDOWN_SERVICE_PROVIDER","ineject","ServiceCompoent","mounted","setTimeout","reference","getBoundingClientRect","onMousedownDocument","contains","target","content","DropdownOption","label","icon","emits","click","dropdownClickHandler","$$dropdown","editData","add","reset","onDelete","table","options","map","row","field","$index","$$tablePropEditor","TablePropEditor","propConfig","showKey","VisualOperatorEditor","Function","container","immediate","renderEditor","color","select","entries","step","VisualEditor","containerRef","containerStyle","selectIndex","selectBlock","preview","editing","clearFocus","filter","showBlockData","editReadonly","importBlockData","text","parse","error","console","alert","openEdit","menuDragier","containerHandler","dragenter","dataTransfer","dropEffect","dragover","dragleave","drop","offsetY","offsetX","blockHandler","focusHandler","onMousedown","currentTarget","blockDraggier","mark","x","y","dragState","startPos","markLines","currentLeft","currentTop","currentMark","showTop","showLeft","lines","w","h","onContextmenuBlock","buttons","tip","log","btn","onContextmenu","NumberRange","startModel","endModel","createEditorInputProp","createEditorColorProp","createEditorSelectProp","createEditorTableProp","fontSize","onChange","url","components","username","subBtn","$notify","message","mySelect","acctType","App","use"],"mappings":"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","file":"js/app.be83aba2.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/vue-dragable/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","<template>\n    <div class=\"app\">\n        <h1>这是渲染页面</h1>\n        <visual-editor\n            v-model=\"jsonData\"\n            :config=\"visualConfig\"\n            :formData=\"formData\"\n            :customProps=\"customProps\"\n        >\n            <!-- <template #subBtn>\n                <el-button v-if=\"formData.food === 'dangao'\">自定义按钮</el-button>\n                <el-tag v-else>自定义标签</el-tag>\n            </template> -->\n        </visual-editor>\n\n        <div style=\"text-align: center\">\n            {{ JSON.stringify(formData) }}\n        </div>\n    </div>\n</template>\n\n<script>\nimport { defineComponent } from 'vue'\nimport { VisualEditor } from '@/packages/visual-editor.tsx'\nimport { visualConfig } from './visual.config'\nimport jsonData from './data.json'\n\nexport default defineComponent({\n    name: 'App',\n    components: {\n        VisualEditor,\n    },\n    data() {\n        return {\n            visualConfig,\n            jsonData,\n            formData: {\n                username: 'admin',\n            },\n            customProps: {\n                subBtn: {\n                    onClick: () => {\n                        this.$notify({ message: '执行' })\n                    },\n                },\n                mySelect: {\n                    onChange: (val) => {\n                        this.$notify({ message: val })\n                        this.formData.acctType = null;\n                    },\n                },\n            },\n        }\n    },\n})\n</script>\n\n<style lang=\"scss\">\nhtml,\nbody {\n    margin: 0;\n    border: 0;\n}\n.app {\n    padding-bottom: 300px;\n}\n</style>\n","type SimplyListener = () => void;\n\nexport function createEvent(){\n    let listeners: SimplyListener[] = [];\n    return {\n        on: (cb: SimplyListener)=>{\n            listeners.push(cb)\n        },\n        off: (cb: SimplyListener)=>{\n            const index = listeners.indexOf(cb);\n            if(index > -1) listeners.splice(index,1);\n        },\n        emit: ()=>{\n            listeners.forEach(item=>item());\n        },\n    }\n}","interface Defer {\n    (): {\n        resolve: () => void;\n        reject: () => void;\n        promise: Promise<void>;\n    };\n    <T>(): {\n        resolve: (val: T) => void;\n        reject: () => void;\n        promise: Promise<T>;\n    };\n}\n\nexport const defer: Defer = () => {\n    const dfd = {} as any;\n    dfd.promise = new Promise((resolve, reject) => {\n        dfd.resolve = resolve as any;\n        dfd.reject = reject;\n    })\n    return dfd;\n}","import { createApp, defineComponent, getCurrentInstance, PropType, reactive } from \"vue\";\nimport { defer } from \"./defer\";\nimport { ElInput, ElDialog, ElButton } from 'element-plus'; // 使用局部组件\n\nenum DialogServiceEditType {\n    textarea = 'textarea',\n    input = 'input'\n}\n\ninterface DialogServiceOption {\n    title?: string;\n    editType: DialogServiceEditType;\n    editReadonly?: boolean;\n    editValue?: string | null;\n    onConfirm: (val?: string | null) => void;\n}\n\nconst keyGenerator = (()=>{\n    let count = 0;\n    return ()=>`auto_key_${count++}`\n})()\n\nconst ServiceComponent = defineComponent({\n    props: {\n        option: {\n            type: Object as PropType<DialogServiceOption>, required: true\n        }\n    },\n    setup(props) {\n        const ctx = getCurrentInstance()!\n        const state = reactive({\n            option: props.option,\n            editValue: null as undefined | null | string,\n            showFlag: false,\n            key:keyGenerator()\n        })\n        const methods = {\n            service: (option: DialogServiceOption) => {\n                state.option = option;\n                state.editValue = option.editValue;\n                state.key = keyGenerator();\n                methods.show();\n            },\n            show: () => {\n                state.showFlag = true;\n            },\n            hide: () => {\n                state.showFlag = false;\n            }\n        }\n        const handler = {\n            onConfirm: () => {\n                state.option.onConfirm(state.editValue);\n                methods.hide();\n            },\n            onCancel: () => {\n                methods.hide();\n            }\n        }\n        Object.assign(ctx.proxy, methods);\n        return () => (\n            // @ts-ignore\n            <ElDialog v-model={state.showFlag} title={state.option.title} key={state.key}>\n                {{\n                    default: () => (\n                        <div>\n                            {\n                                state.option.editType === DialogServiceEditType.textarea ?\n                                    (\n                                        <ElInput type=\"textarea\" {...{ rows: 10 }} v-model={state.editValue} />\n                                    ) : (\n                                        <ElInput {...{ rows: 10 }} v-model={state.editValue} />\n                                    )\n                            }\n                        </div>\n                    ),\n                    footer: () => (\n                        <div>\n                            <ElButton {...{ onClick: handler.onCancel } as any}>取消</ElButton>\n                            <ElButton {...{ onClick: handler.onConfirm } as any}>确定</ElButton>\n                        </div>\n                    )\n                }}\n            </ElDialog>\n        )\n    }\n});\n\nconst DialogService = (() => {\n    let ins: any;\n    return (option: DialogServiceOption) => {\n        if (!ins) {\n            const el = document.createElement('div');\n            document.body.appendChild(el);\n            const app = createApp(ServiceComponent, { option });\n            ins = app.mount(el);\n        }\n        ins.service(option);\n    }\n})()\n\nexport const $$dialog = Object.assign(DialogService, {\n    input: (initValue?: string, title?: string, option?: Omit<DialogServiceOption, 'editType' | 'onConfirm'>) => {\n        const dfd = defer<string | null | undefined>();\n        const opt: DialogServiceOption = {\n            ...option,\n            editType: DialogServiceEditType.input,\n            onConfirm: dfd.resolve,\n            editValue:initValue,\n            title\n        }\n        DialogService(opt);\n        return dfd.promise;\n    },\n    textarea: (initValue?: string, title?: string, option?: Omit<DialogServiceOption,'editType'|'onConfirm'>) => {\n        const dfd = defer<string | null | undefined>();\n        const opt: DialogServiceOption = {\n            ...option,\n            editType: DialogServiceEditType.textarea,\n            onConfirm: dfd.resolve,\n            editValue: initValue,\n            title\n        }\n        DialogService(opt);\n        return dfd.promise;\n    }\n})","import { defineComponent, ref, watch } from \"vue\";\n\nexport function useModel<T>(getter: () => T, emitter: (val: T) => void) {\n    const state = ref(getter()) as { value: T };\n    watch(getter, val => {\n        if (val !== state.value) {\n            state.value = val;\n        }\n    })\n    return {\n        get value() { return state.value },\n        set value(val: T) {\n            if (state.value !== val) {\n                state.value = val;\n                emitter(val);\n            }\n        }\n    }\n}\n\nexport const TestUseModel = defineComponent({\n    props: {\n        modelValue: { type: String }\n    },\n    emit: {\n        'update:modelValue': (val?: string) => true\n    },\n    setup(props, ctx) {\n        const model = useModel(() => props.modelValue, val => ctx.emit('update:modelValue', val));\n        return () => (\n            <div>\n                自定义输入框\n                <input type=\"text\" v-model={model.value} />\n            </div>\n        )\n    }\n})","import { inject, Prop, provide } from \"vue\";\nimport { VisualEditorProps } from \"./visual-editor.props\";\n\nexport interface VisualEditorBlockData {\n    componentKey: string;               // 映射VisualEditorConfig 中 componentMap 的对象\n    top: number;                        // 组件的top定位\n    left: number;                       // 组件的left定位\n    adjustPosition: boolean;            // 是否需要调整位置\n    focus: boolean;                     // 是否是选中状态\n    zIndex: number;                     // z-index值\n    width: number;                      // 组件宽度\n    height: number;                     // 组件高度\n    hasResize: boolean;                 // 是否调整过宽度或高度\n    props: Record<string, any>;         // 组件的设计属性\n    model: Record<string, string>;      // 绑定的字段\n    slotName?: string;                    // 组件唯一标识\n}\nexport interface VisualEditorModelValue {\n    container: {\n        width: number;\n        height: number;\n    };\n    blocks?: VisualEditorBlockData[];\n}\n\nexport interface VisualEditorComponent {\n    key: string;\n    label: string;\n    preview: () => JSX.Element;\n    render: (data: {\n        props: any;\n        model: any;\n        size: { width?: number; height?: number };\n        custom: Record<string, any>;\n    }) => JSX.Element;\n    props?: Record<string, VisualEditorProps>;\n    model?: Record<string, string>;\n    resize?: { width?: boolean; height?: boolean };\n}\n\nexport interface VisualEditorMarkLines {\n    x: { left: number; showLeft: number }[];\n    y: { top: number; showTop: number }[];\n}\n\nexport function createNewBlock({\n    component,\n    left,\n    top\n}: {\n    component: VisualEditorComponent;\n    top: number;\n    left: number;\n}): VisualEditorBlockData {\n    return {\n        top,\n        left,\n        componentKey: component!.key,\n        adjustPosition: true,\n        focus: false,\n        zIndex: 0,\n        width: 0,\n        height: 0,\n        hasResize: false,\n        props: {},\n        model: {},\n    }\n}\n\nexport function createVisualEditorConfig() {\n    const componentList: VisualEditorComponent[] = [];\n    const componentMap: Record<string, VisualEditorComponent> = {};\n    return {\n        componentList,\n        componentMap,\n        registry: <_,\n            Props extends Record<string, VisualEditorProps> = {},\n            Model extends Record<string, string> = {}\n        >(key: string, component: {\n            label: string;\n            preview: () => JSX.Element;\n            render: (data: {\n                props: { [k in keyof Props]: any };\n                model: Partial<{ [k in keyof Model]: any }>;\n                size: { width?: number; height?: number };\n                custom: Record<string, any>;\n            }) => JSX.Element;\n            props?: Props;\n            model?: Model;\n            resize?: { width?: boolean; height?: boolean };\n        }) => {\n            const comp = { ...component, key };\n            componentList.push(comp); // 按照注册的顺序进行组件渲染\n            componentMap[key] = comp;\n        }\n    }\n}\n\nexport type VisualEditorConfig = ReturnType<typeof createVisualEditorConfig>;\n\nexport interface VisualDragEvent {\n    dragstart: {\n        on: (cb: () => void) => void;\n        off: (cb: () => void) => void;\n        emit: () => void;\n    };\n    dragend: {\n        on: (cb: () => void) => void;\n        off: (cb: () => void) => void;\n        emit: () => void;\n    };\n}\nexport const VisualProvider = (() => {\n    const VISUAL_DRAG_PROVIDER = \"@@VISUAL_DRAG_PROVIDER\";\n    return {\n        provide: (data: VisualDragEvent) => {\n            provide(VISUAL_DRAG_PROVIDER, data);\n        },\n        inject: () => {\n            return inject(VISUAL_DRAG_PROVIDER) as VisualDragEvent;\n        }\n    }\n})()","import { VisualEditorBlockData, VisualEditorComponent, VisualProvider } from \"@/packages/visual-editor.utils\";\nimport { defineComponent, PropType } from \"vue\";\nimport \"@/packages/visual-editor.scss\"\n\nenum Direction {\n    start = 'start',\n    center = 'center',\n    end = 'end',\n}\n\nexport const BlockResize = defineComponent({\n    props: {\n        block: { type: Object as PropType<VisualEditorBlockData>, required: true },\n        component: { type: Object as PropType<VisualEditorComponent>, required: true },\n    },\n    setup(props, ctx) {\n        const { dragstart, dragend } = VisualProvider.inject();\n        const onMousedown = (() => {\n            let data = {\n                startX: 0,\n                startY: 0,\n                startWidth: 0,\n                startHeight: 0,\n                startLeft: 0,\n                startTop: 0,\n                dragging:false,\n                direction: {\n                    horizontal: Direction.start,\n                    vertical: Direction.start\n                }\n            }\n            const mousedown = (e: MouseEvent, direction: { horizontal: Direction; vertical: Direction }) => {\n                e.stopPropagation();\n                document.body.addEventListener('mousemove', mousemove);\n                document.body.addEventListener('mouseup', mouseup);\n                data = {\n                    startX: e.clientX,\n                    startY: e.clientY,\n                    startWidth: props.block.width,\n                    startHeight: props.block.height,\n                    startLeft: props.block.left,\n                    startTop: props.block.top,\n                    dragging:false,\n                    direction,\n                }\n            }\n            const mousemove = (e: MouseEvent) => {\n                let { startX, startY, startWidth, startHeight, direction, startLeft, startTop,dragging } = data;\n                if(!dragging){\n                    data.dragging  = true;\n                    dragstart.emit();\n                }\n                let { clientX: moveX, clientY: moveY } = e;\n                if (direction.horizontal === Direction.center) {\n                    moveX = startX;\n                }\n                if (direction.vertical === Direction.center) {\n                    moveY = startY;\n                }\n                let durX = moveX - startX;\n                let durY = moveY - startY;\n                const block = props.block as VisualEditorBlockData;\n\n                if (direction.vertical === Direction.start) {\n                    durY = -durY;\n                    block.top = startTop - durY;\n                }\n                if (direction.horizontal === Direction.start) {\n                    durX = -durX;\n                    block.left = startLeft - durX;\n                }\n                const width = startWidth + durX;\n                const height = startHeight + durY;\n                block.width = width;\n                block.height = height;\n                block.hasResize = true;\n            }\n            const mouseup = () => {\n                document.body.removeEventListener('mousemove', mousemove);\n                document.body.removeEventListener('mouseup', mouseup);\n                if(data.dragging){\n                    dragend.emit();\n                }\n            }\n            return mousedown;\n        })()\n        return () => {\n            const { width, height } = props.component.resize || {};\n            return <>\n                {!!height && <>\n                    <div class=\"block-resize block-resize-top\" onMousedown={e => onMousedown(e, { horizontal: Direction.center, vertical: Direction.start })} />\n                    <div class=\"block-resize block-resize-bottom\" onMousedown={e => onMousedown(e, { horizontal: Direction.center, vertical: Direction.end })} /></>}\n                {!!width && <>\n                    <div class=\"block-resize block-resize-left\" onMousedown={e => onMousedown(e, { horizontal: Direction.start, vertical: Direction.center })} />\n                    <div class=\"block-resize block-resize-right\" onMousedown={e => onMousedown(e, { horizontal: Direction.end, vertical: Direction.center })} />\n                </>}\n                {!!width && !!height && <>\n                    <div class=\"block-resize block-resize-top-left\" onMousedown={e => onMousedown(e, { horizontal: Direction.start, vertical: Direction.start })} />\n                    <div class=\"block-resize block-resize-top-right\" onMousedown={e => onMousedown(e, { horizontal: Direction.end, vertical: Direction.start })} />\n                    <div class=\"block-resize block-resize-bottom-left\" onMousedown={e => onMousedown(e, { horizontal: Direction.start, vertical: Direction.end })} />\n                    <div class=\"block-resize block-resize-bottom-right\" onMousedown={e => onMousedown(e, { horizontal: Direction.end, vertical: Direction.end })} />\n                </>}\n            </>\n        }\n    }\n})","import { computed, defineComponent, onMounted, PropType, ref, Slot } from \"vue\";\nimport { BlockResize } from \"./components/block-resizer/block-resize\";\nimport { VisualEditorBlockData, VisualEditorConfig } from \"./visual-editor.utils\";\n\nexport const VisualEditorBlock = defineComponent({\n    props: {\n        block: { type: Object as PropType<VisualEditorBlockData>, required: true },\n        config: { type: Object as PropType<VisualEditorConfig>, required: true },\n        formData: { type: Object as PropType<Record<string, any>>, required: true },\n        slots: { type: Object as PropType<Record<string, Slot | undefined>>, required: true },\n        customProps: { type: Object as PropType<Record<string, any>> },\n    },\n    setup(props) {\n        const el = ref({} as HTMLDivElement);\n\n        const classes = computed(() => [\n            'visual-editor-block',\n            {\n                'visual-editor-block-focus': props.block.focus\n            }\n        ])\n\n        const styles = computed(() => ({\n            top: `${props.block.top}px`,\n            left: `${props.block.left}px`,\n            zIndex: props.block.zIndex,\n        }))\n        onMounted(() => {\n            /** 添加组件时，自动调整位置上下左右居中 */\n            const block = props.block;\n            if (block.adjustPosition === true) {\n                const { offsetWidth, offsetHeight } = el.value;\n                block.left = block.left - offsetWidth / 2;\n                block.top = block.top - offsetHeight / 2;\n                block.height = offsetHeight;\n                block.width = offsetWidth;\n                block.adjustPosition = false;\n            }\n        });\n        return () => {\n            const component = props.config.componentMap[props.block.componentKey];\n            const formData = props.formData as Record<string, any>;\n            let render: any;\n            if (!!props.block.slotName && !!props.slots[props.block.slotName]) {\n                render = props.slots[props.block.slotName]!();\n            } else {\n                render = component.render({\n                    size: props.block.hasResize ? {\n                        width: props.block.width,\n                        height: props.block.height,\n                    } : {},\n                    props: props.block.props || {},\n                    model: Object.keys(component.model || {}).reduce((prev, propName) => {\n                        const modelName = !props.block.model ? null : props.block.model[propName];\n                        prev[propName] = {\n                            [propName === 'default' ? 'modelValue' : propName]: !!modelName ? formData[modelName] : null,\n                            [propName === 'default' ? 'onUpdate:modelValue' : 'onChange']: (val: any) => {\n                                return !!modelName && (formData[modelName] = val);\n                            },\n                        }\n                        return prev;\n                    }, {} as Record<string, any>),\n                    custom: (!props.block.slotName || !props.customProps) ? {} : (props.customProps[props.block.slotName]||{})\n                });\n            }\n            const { width, height } = component.resize || {};\n            return (\n                <div class={classes.value} style={styles.value} ref={el}>\n                    {render}\n                    {!!props.block.focus && (!!width || !!height) && <BlockResize block={props.block} component={component} />}\n                </div>\n            )\n        }\n    }\n})","export const keyboardCode = {\n    16:'shift',\n    17:'ctrl',\n    18:'alt',\n    \n    8:'backspace',\n    9:'tab',\n    13:'enter',\n    27:'esc',\n    32:'space',\n    \n    37:'left',\n    38:'up',\n    39:'right',\n    40:'bottom',\n    46:'delete',\n    189:'-',\n    187:'=',\n    \n    48:'0',\n    49:'1',\n    50:'2',\n    51:'3',\n    52:'4',\n    53:'5',\n    54:'6',\n    55:'7',\n    56:'8',\n    57:'9',\n    \n    65:'a',\n    66:'b',\n    67:'c',\n    68:'d',\n    69:'e',\n    70:'f',\n    71:'g',\n    72:'h',\n    73:'i',\n    74:'j',\n    75:'k',\n\n    76:'l',\n    77:'m',\n    78:'n',\n    79:'o',\n    80:'p',\n    81:'q',\n    82:'r',\n    83:'s',\n    84:'t',\n    85:'u',\n    86:'v',\n    87:'w',\n    88:'x',\n    89:'y',\n    90:'z',\n\n    112:'F1',\n    113:'F2',\n    114:'F3',\n    115:'F4',\n    116:'F5',\n    117:'F6',\n    118:'F7',\n    119:'F8',\n    120:'F9',\n    121:'F10',\n    122:'F11',\n    123:'F12',\n} as Record<number,string>","import { onUnmounted, reactive } from \"vue\";\nimport { keyboardCode } from \"./keyboard-code\";\n\nexport interface CommandExecute {\n    undo?: () => void;\n    redo: () => void;\n}\n\nexport interface Command {\n    name: string;                                   // 命令唯一标识\n    keyboard?: string | string[];                   // 命令监听的快捷键   \n    execute: (...args: any[]) => CommandExecute;    // 命令被执行时，所做的事\n    followQueue?: boolean;                          // 命令执行完后，是否要将命令执行得到的undo，redo放入命令队列\n    init?: () => (() => void | undefined);          // 命令初始化函数\n    data?: any;                                     // 命令缓存所需要的数据\n}\n\nexport function useCommander() {\n    const state = reactive({\n        current: -1,                                                // 对列中当前的命令\n        queue: [] as CommandExecute[],                              // 命令队列\n        commandArray: [] as Command[],                              // 命令对象数组\n        commands: {} as Record<string, (...args: any[]) => void>,   // 命令对象，方便通过命令的名称调用命令的execute函数，并执行额外的命令队列\n        destroyList: [] as ((() => void) | undefined)[]             // 组件销毁的时候，需要调用\n    });\n\n    /* 注册一个命令 */\n    const registry = (command: Command) => {\n        state.commandArray.push(command);\n        state.commands[command.name] = (...args) => {\n            const { undo, redo } = command.execute(...args);\n            redo();\n            /* 如果命令执行结束后，不需要进入命令队列，则直接结束 */\n            if (command.followQueue === false) {\n                return;\n            }\n\n            /* 否则，将命令队列中的剩余命令去掉，保留current后面的 */\n            let { queue, current } = state;\n            if (queue.length > 0) {\n                queue = queue.slice(0, current + 1);   // 当前命令之前的都不要了，只要current后面的\n                state.queue = queue;\n            }\n            /* 设置命令队列中的最后一个为当前执行的命令 */\n            queue.push({ undo, redo });\n            /* 索引+1 指向命令队列中的最后一个命令 */\n            state.current = current + 1;\n        }\n    }\n\n    const keyboardEvent = (() => {\n        const onKeydown = (e: KeyboardEvent) => {\n            if (document.activeElement !== document.body) return;\n            const { keyCode, shiftKey, altKey, ctrlKey, metaKey } = e;\n            let keyString: string[] = [];\n            if (ctrlKey || metaKey) keyString.push('ctrl');\n            if (shiftKey) keyString.push('shift');\n            if (altKey) keyString.push('alt');\n            keyString.push(keyboardCode[keyCode]);\n\n            const keyNames = keyString.join('+');\n            state.commandArray.forEach(({keyboard,name})=>{\n                if(!keyboard) return;\n                const keys = Array.isArray(keyboard)? keyboard : [keyboard];\n                if(keys.indexOf(keyNames) > -1){\n                    state.commands[name]();\n\n                    // 下面两行是为了快捷键执行功能时，阻止网页的默认事件\n                    e.stopPropagation();\n                    e.preventDefault();// 阻止ctrl+d收藏网页的默认行为\n                }\n            })\n            \n        }\n        const init = () => {\n            window.addEventListener('keydown', onKeydown);\n            return () => window.removeEventListener('keydown', onKeydown);\n        }\n        return init;\n    })()\n\n    /**\n     * useCommander初始化函数，负责初始化监听键盘事件、命令的初识话逻辑\n     */\n    const init = () => {\n        const onKeydown = (e: KeyboardEvent) => {\n            // console.log(\"监听到键盘事件\");\n\n        }\n        window.addEventListener('keydown', onKeydown);\n        state.commandArray.forEach(command => !!command.init && state.destroyList.push(command.init()));\n        state.destroyList.push(keyboardEvent());\n        state.destroyList.push(() => {\n            window.removeEventListener('keydown', onKeydown);\n        })\n    }\n    // 注册撤销命令 (撤回命令的执行结果不需要进队列 ？)\n    registry({\n        name: 'undo',\n        keyboard: 'ctrl+z',\n        followQueue: false,\n        execute: () => {\n            // 命令被执行时，要做的事情\n            return {\n                redo: () => {\n                    // 重新做一遍要做的事情\n                    if (state.current === -1) return;\n                    const queueItem = state.queue[state.current];\n                    if (!!queueItem) {\n                        !!queueItem.undo && queueItem.undo();\n                        state.current--;\n                    }\n                }\n            }\n        }\n    })\n    registry({\n        name: 'redo',\n        keyboard: [\n            'ctrl+y',\n            'ctrl+shift+z'\n        ],\n        followQueue: false,\n        execute: () => {\n            return {\n                redo: () => {\n                    // console.log(\"执行重做命令\");\n                    const queueItem = state.queue[state.current + 1];\n                    if (!!queueItem) {\n                        queueItem.redo();\n                        state.current++;\n                    }\n                }\n            }\n        }\n    })\n    onUnmounted(() => {\n        state.destroyList.forEach(fn => !!fn && fn());\n    })\n    return {\n        state,\n        registry,\n        init\n    }\n}","import { useCommander } from \"@/packages/plugins/command.plugin\";\nimport deepcopy from \"deepcopy\";\nimport { VisualEditorBlockData, VisualEditorModelValue } from \"./visual-editor.utils\";\n\nexport function useVisualCommand({\n    focusData,\n    updateBlocks,\n    dataModel,\n    dragstart,\n    dragend,\n}: {\n    focusData: { value: { focus: VisualEditorBlockData[]; unFocus: VisualEditorBlockData[] } };\n    updateBlocks: (blocks?: VisualEditorBlockData[]) => void;\n    dataModel: { value: VisualEditorModelValue };\n    dragstart: { on: (cb: () => void) => void; off: (cb: () => void) => void };\n    dragend: { on: (cb: () => void) => void; off: (cb: () => void) => void };\n}) {\n    const commander = useCommander();\n\n    /**\n     * 删除命令\n     */\n    commander.registry({\n        name: 'delete',\n        keyboard: [\n            'backspace',\n            'delete',\n            'ctrl+d'\n        ],\n        execute: () => {\n            // console.log(\"执行删除命令\");\n            const data = {\n                before: dataModel.value.blocks || [], // 先存一份执行之前的数据\n                after: focusData.value.unFocus          // 执行之后的数据\n            }\n            return {\n                redo: () => {\n                    // console.log(\"重做删除命令\", data.after);\n                    updateBlocks(deepcopy(data.after));\n                },\n                undo: () => {\n                    // console.log(\"撤回删除命令\");\n                    updateBlocks(deepcopy(data.before));\n                }\n            }\n        }\n    });\n\n    /**\n     * 拖拽命令，适用三种情况\n     * - 从菜单拖拽组件到容器画布\n     * - 从容器中拖拽调整组件位置\n     * - 拖拽调整组件的宽度和高度\n     */\n    commander.registry({\n        name: 'drag',\n        init() {\n            this.data = { before: null as null | VisualEditorBlockData[] }\n            const handler = {\n                dragstart: () => {\n                    this.data.before = deepcopy(dataModel.value.blocks);\n                },\n                dragend: () => {\n                    commander.state.commands.drag();\n                }\n            }\n            dragstart.on(handler.dragstart);\n            dragend.on(handler.dragend);\n            return () => {\n                dragstart.off(handler.dragstart);\n                dragend.off(handler.dragend);\n            }\n        },\n        execute() {\n            let before = deepcopy(this.data.before);\n            let after = deepcopy(dataModel.value.blocks);\n\n            return {\n                redo: () => {\n                    updateBlocks(deepcopy(after));\n                },\n                undo: () => {\n                    updateBlocks(deepcopy(before));\n                },\n            }\n        }\n    })\n    commander.registry({\n        name: 'clear',\n        execute: () => {\n            let data = {\n                before: deepcopy(dataModel.value.blocks),\n                after: deepcopy([])\n            }\n\n            return {\n                redo: () => {\n                    updateBlocks(deepcopy(data.after))\n                },\n                undo: () => {\n                    updateBlocks(deepcopy(data.before));\n                }\n            }\n        }\n    })\n    commander.registry({\n        name: \"placeTop\",\n        keyboard: \"ctrl+up\",\n        execute: () => {\n            let data = {\n                before: deepcopy(dataModel.value.blocks),\n                after: deepcopy((() => {\n                    const { focus, unFocus } = focusData.value;\n                    const maxZIndex = unFocus.reduce((pre, block) => Math.max(pre, block.zIndex), -Infinity) + 1;\n                    focus.forEach(block => block.zIndex = maxZIndex);\n                    return deepcopy(dataModel.value.blocks);\n                })())\n            }\n            return {\n                redo: () => {\n                    updateBlocks(deepcopy(data.after))\n                },\n                undo: () => {\n                    updateBlocks(deepcopy(data.before))\n                }\n            }\n        }\n    })\n    commander.registry({\n        name: \"placeBottom\",\n        keyboard: \"ctrl+bottom\",\n        execute: () => {\n            let data = {\n                before: deepcopy(dataModel.value.blocks),\n                after: deepcopy((() => {\n                    const { focus, unFocus } = focusData.value;\n                    let minZIndex = unFocus.reduce((pre, block) => Math.min(pre, block.zIndex), Infinity) - 1;\n                    if (minZIndex < 0) {\n                        const dur = Math.abs(minZIndex);\n                        unFocus.forEach(block => block.zIndex += dur);\n                        minZIndex = 0;\n                    }\n                    focus.forEach(block => block.zIndex = minZIndex);\n                    return deepcopy(dataModel.value.blocks);\n                })())\n            }\n            return {\n                redo: () => {\n                    updateBlocks(deepcopy(data.after))\n                },\n                undo: () => {\n                    updateBlocks(deepcopy(data.before))\n                }\n            }\n        }\n    })\n    commander.registry({\n        name: \"updateBlock\",\n        execute: (newBlock: VisualEditorBlockData, oldBlock: VisualEditorBlockData) => {\n            let blocks = deepcopy(dataModel.value.blocks || []);\n            let data = {\n                before: blocks,\n                after: (() => {\n                    blocks = [...blocks];\n                    const index = dataModel.value.blocks!.indexOf(oldBlock);// 在原先的数据中找出oldBlock的索引\n                    if (index > -1) {\n                        blocks.splice(index, 1, newBlock);\n                    }\n                    return deepcopy(blocks);\n                })()\n            }\n            return {\n                redo: () => {\n                    updateBlocks(deepcopy(data.after))\n                },\n                undo: () => {\n                    updateBlocks(deepcopy(data.before))\n                }\n            }\n        }\n    })\n    commander.registry({\n        name: \"updateModelValue\",\n        execute: (val: VisualEditorModelValue) => {\n            let data = {\n                before: deepcopy(dataModel.value),\n                after: deepcopy(val)\n            }\n            return {\n                redo: () => {\n                    dataModel.value = data.after;\n                },\n                undo: () => {\n                    dataModel.value = data.before;\n                },\n            }\n        }\n    })\n    commander.registry({\n        name:'selectAll',\n        followQueue:false,\n        keyboard:'ctrl+a',\n        execute:()=>{\n            return {\n                redo:()=>{\n                    (dataModel.value.blocks || []).forEach(block => block.focus = true)\n                }\n            }\n        }\n    })\n    commander.init();\n    return {\n        undo: () => commander.state.commands.undo(),\n        redo: () => commander.state.commands.redo(),\n        delete: () => commander.state.commands.delete(),\n        clear: () => commander.state.commands.clear(),\n        placeTop: () => commander.state.commands.placeTop(),\n        placeBottom: () => commander.state.commands.placeBottom(),\n        updateBlock: (newBlock: VisualEditorBlockData, oldBlock: VisualEditorBlockData) => commander.state.commands.updateBlock(newBlock, oldBlock),\n        updateModelValue: (val: VisualEditorModelValue) => { commander.state.commands.updateModelValue(val) }\n    }\n}","import { VisualEditorSelectOptions, VisualEditorTableOption } from \"@/visual.config\";\n\nexport enum VisualEditorPropsType {\n    input = \"input\",\n    color = \"color\",\n    select = \"select\",\n    table = \"table\",\n}\nexport type VisualEditorProps = {\n    type: VisualEditorPropsType;\n    label: string;\n} & {\n    options?: VisualEditorSelectOptions;\n} & {\n    table?: VisualEditorTableOption;\n}","import { computed, createApp, defineComponent, getCurrentInstance, inject, onBeforeUnmount, onMounted, PropType, provide, reactive, ref } from \"vue\";\nimport { defer } from \"./defer\";\nimport './dropdown-service.scss'\n\ninterface DropdownServiceOption {\n    reference: MouseEvent | HTMLElement;\n    content: () => JSX.Element;\n}\n\nconst DropdownServiceProvider = (() => {\n    const DROPDOWN_SERVICE_PROVIDER = '@@DROPDOWN_SERVICE_PROVIDER';\n    return {\n        provide: (handler: { onClick: () => void }) => provide(DROPDOWN_SERVICE_PROVIDER, handler),\n        ineject: () => inject(DROPDOWN_SERVICE_PROVIDER) as { onClick: () => void },\n    }\n})()\n\nconst ServiceCompoent = defineComponent({\n    props: { option: { type: Object as PropType<DropdownServiceOption>, required: true } },\n    setup(props) {\n        const ctx = getCurrentInstance()!\n        const el = ref({} as HTMLDivElement);\n\n        const state = reactive({\n            option: props.option,\n            showFlag: false,\n            top: 0,\n            left: 0,\n            mounted: (() => {\n                const dfd = defer();\n                onMounted(() => {\n                    setTimeout(() => dfd.resolve(), 0);\n                });\n                return dfd.promise;\n            })()\n        })\n        const service = (option: DropdownServiceOption) => {\n            state.option = option;\n\n            if ('addEventListener' in option.reference) {\n                const { top, left, height } = option.reference.getBoundingClientRect()!\n                state.top = top + height;\n                state.left = left;\n            } else {\n                const { clientX, clientY } = option.reference;\n                state.top = clientY;\n                state.left = clientX;\n            }\n            methods.show();\n        }\n        const methods = {\n            show: async () => {\n                await state.mounted;\n                state.showFlag = true;\n            },\n            hide: () => {\n                state.showFlag = false;\n            }\n        }\n        const classes = computed(() => [\n            'dropdown-service',\n            {\n                'dropdown-service-show': state.showFlag\n            }\n        ])\n        const styles = computed(() => ({\n            top: `${state.top}px`,\n            left: `${state.left}px`,\n        }))\n        Object.assign(ctx.proxy, { service });\n\n        const onMousedownDocument = (e: MouseEvent) => {\n            // 这种写法导致右键菜单点击失效\n            // if (!(e.target as HTMLDivElement).contains(el.value)) {\n            //     methods.hide();\n            // }\n\n            if (!el.value.contains((e.target as HTMLDivElement))) {\n                methods.hide();\n            }\n        }\n        onMounted(() => document.body.addEventListener('mousedown', onMousedownDocument, true));\n        onBeforeUnmount(() => document.body.removeEventListener('mousedown', onMousedownDocument, true))\n        DropdownServiceProvider.provide({ onClick: methods.hide });\n        return () => (\n            <div class={classes.value} style={styles.value} ref={el}>\n                {state.option.content()}\n            </div>\n        )\n    }\n})\n\nexport const DropdownOption = defineComponent({\n    props: {\n        label: { type: String },\n        icon: { type: String },\n    },\n    emits: {\n        click: (e: MouseEvent) => true\n    },\n    setup(props, ctx) {\n        const { onClick: dropdownClickHandler } = DropdownServiceProvider.ineject();\n        const handler = {\n            onClick: (e: MouseEvent) => {\n                ctx.emit('click', e);\n                dropdownClickHandler();\n            }\n        }\n        return () => (\n            <div class=\"dropdown-option\" onClick={handler.onClick}>\n                <i class={`iconfont ${props.icon}`}></i>\n                <span>{props.label}</span>\n            </div>\n        )\n    }\n})\n\n// 当前服务动态挂载到根结点，会丢失上下文，所以不能inject全局provide的数据，即不能通过inject获取provide提供的数据\n// 这种服务就会有缺陷，因此用$$标注\nexport const $$dropdown = (() => {\n    let ins: any;\n    return (option: DropdownServiceOption) => {\n        if (!ins) {\n            const el = document.createElement('div');\n            document.body.appendChild(el);\n            const app = createApp(ServiceCompoent, { option });\n            app.component('dropdown-option', DropdownOption);\n            ins = app.mount(el);\n        }\n        ins.service(option);\n    }\n})()","import { defer } from \"@/packages/utils/defer\";\nimport { VisualEditorProps } from \"@/packages/visual-editor.props\";\nimport deepcopy from \"deepcopy\";\nimport { ElButton, ElDialog, ElInput, ElTable, ElTableColumn } from \"element-plus\";\nimport { createApp, defineComponent, getCurrentInstance, onMounted, PropType, reactive } from \"vue\";\n\nexport interface TablePropEditorServiceOption {\n    data: any[];\n    config: VisualEditorProps;\n    onConfirm: (val: any[]) => void;\n}\n\nconst ServiceCompoent = defineComponent({\n    props: {\n        option: { type: Object as PropType<TablePropEditorServiceOption>, required: true },\n    },\n    setup(props) {\n        const ctx = getCurrentInstance()!\n        const state = reactive({\n            option: props.option,\n            showFlag: false,\n            mounted: (() => {\n                const dfd = defer();\n                onMounted(() => {\n                    setTimeout(() => dfd.resolve(), 0);\n                });\n                return dfd.promise;\n            })(),\n            editData: [] as any[]\n        })\n\n        const methods = {\n            service: (option: TablePropEditorServiceOption) => {\n                state.option = option;\n                state.editData = deepcopy(option.data);\n                methods.show();\n            },\n            show: async () => {\n                await state.mounted;\n                state.showFlag = true;\n            },\n            hide: () => {\n                state.showFlag = false;\n            },\n            add: () => {\n                state.editData.push({});\n            },\n            reset: () => {\n                state.editData = deepcopy(state.option.data);\n            }\n        }\n\n        const handler = {\n            onConfirm: () => {\n                state.option.onConfirm(state.editData);\n                methods.hide();\n            },\n            onCancel: () => {\n                methods.hide();\n            },\n            onDelete: (index: number) => {\n                state.editData.splice(index,1);\n            }\n        }\n\n        Object.assign(ctx.proxy!, methods);\n\n        // @ts-ignore\n        return () => <ElDialog v-model={state.showFlag}>\n            {{\n                default: () => (\n                    <div>\n                        <div>\n                            <ElButton {...{ onClick: methods.add } as any}>添加</ElButton>\n                            <ElButton {...{ onClick: methods.reset } as any}>重置</ElButton>\n                        </div>\n                        <ElTable data={state.editData}>\n                            <ElTableColumn {...{ type: 'index' as any }} />\n                            {state.option.config.table!.options.map((item, index) => (\n                                <ElTableColumn {...{ label: item.label } as any}>\n                                    {{\n                                        default: ({ row }: { row: any }) => <ElInput v-model={row[item.field]} />\n                                    }}\n                                </ElTableColumn>\n                            ))}\n                            <ElTableColumn  {...{ label: \"操作栏\" } as any}>\n                                {{\n                                    default: ({ $index }: { $index: number }) => (\n                                        <ElButton type=\"danger\" {...{ onClick: () => handler.onDelete($index) }}>删除</ElButton>\n\n                                    )\n                                }}\n                            </ElTableColumn>\n                        </ElTable>\n                    </div>\n                ),\n                footer: () => <>\n                    <ElButton {...{ onClick: handler.onCancel } as any}>取消</ElButton>\n                    <ElButton type=\"primary\" {...{ onClick: handler.onConfirm } as any}>确定</ElButton>\n                </>\n            }}\n        </ElDialog>\n    }\n})\nexport const $$tablePropEditor = (() => {\n    let ins: any;\n    return (option: Omit<TablePropEditorServiceOption, 'onConfirm'>) => {\n        if (!ins) {\n            const el = document.createElement('div');\n            document.body.appendChild(el);\n            const app = createApp(ServiceCompoent, { option });\n            ins = app.mount(el);\n        }\n        const dfd = defer<any[]>();\n        ins.service({\n            ...option,\n            onConfirm: dfd.resolve\n        });\n        return dfd.promise;\n    }\n})()","import { useModel } from '@/packages/utils/useModel'\nimport { VisualEditorProps } from '@/packages/visual-editor.props'\nimport { ElButton, ElTag } from 'element-plus'\nimport { defineComponent, PropType } from 'vue'\nimport { $$tablePropEditor } from './table-prop-editor.service'\n\nexport const TablePropEditor = defineComponent({\n    props: {\n        modelValue: { type: Array as PropType<any[]> },\n        propConfig: { type: Object as PropType<VisualEditorProps>, required: true },\n    },\n    emits: {\n        'update:modelValue': (val?: any[]) => true\n    },\n    setup(props, ctx) {\n        const model = useModel(() => props.modelValue, (val) => ctx.emit('update:modelValue', val));\n        const onClick = async () => {\n            const data =await $$tablePropEditor({\n                config:props.propConfig,\n                data:props.modelValue||[]\n            });\n            model.value = data;\n        }\n        \n        return ()=>(\n            <div>\n                {(!model.value || model.value.length === 0) && <ElButton {...{ onClick } as any}>\n                        添加\n                    </ElButton>}\n                {((model.value || []).map(item => (<ElTag {...{onClick} as any}>\n                    {item[props.propConfig.table!.showKey]}\n                </ElTag>)))}\n            </div>\n        )\n    }\n})","import deepcopy from \"deepcopy\";\nimport { ElButton, ElColorPicker, ElForm, ElFormItem, ElInput, ElInputNumber, ElOption, ElSelect } from \"element-plus\";\nimport { defineComponent, PropType, reactive, watch } from \"vue\";\nimport { VisualEditorProps, VisualEditorPropsType } from \"./visual-editor.props\";\nimport { VisualEditorBlockData, VisualEditorConfig, VisualEditorModelValue } from \"./visual-editor.utils\";\nimport { TablePropEditor } from \"./components/table-prop-editor/table-prop-editor\"\nexport const VisualOperatorEditor = defineComponent({\n    props: {\n        block: { type: Object as PropType<VisualEditorBlockData> },\n        config: { type: Object as PropType<VisualEditorConfig>, required: true },\n        dataModel: { type: Object as PropType<{ value: VisualEditorModelValue }>, required: true },\n        updateBlock: {\n            type: Function as PropType<((newBlock: VisualEditorBlockData, oldBlock: VisualEditorBlockData) => void)>,\n            required: true,\n        },\n        updateModelValue: {\n            type: Function as PropType<((val: VisualEditorModelValue) => void)>,\n            required: true\n        }\n    },\n    setup(props) {\n        const state = reactive({\n            editData: '' as any\n        })\n        const methods = {\n            apply: () => {\n                if (!props.block) {\n                    /* 当前编辑容器属性 */\n                    props.updateModelValue({\n                        ...props.dataModel.value,\n                        container: state.editData\n                    });\n                } else {\n                    /* 当前编辑block数据的属性 */\n                    const newBlock = state.editData;\n                    props.updateBlock(newBlock, props.block);\n                }\n            },\n            reset: () => {\n                if (!props.block) {\n                    state.editData = deepcopy(props.dataModel.value.container);\n                } else {\n                    state.editData = deepcopy(props.block);\n                }\n            }\n        }\n        watch(() => props.block, () => {\n            methods.reset();\n        }, { immediate: true })\n        const renderEditor = (propName: string, propConfig: VisualEditorProps) => {\n            return {\n                [VisualEditorPropsType.input]: () => (<ElInput v-model={state.editData.props[propName]} />),\n                [VisualEditorPropsType.color]: () => (<ElColorPicker v-model={state.editData.props[propName]} />),\n                [VisualEditorPropsType.select]: () => (<ElSelect v-model={state.editData.props[propName]}>\n                    {/* {(()=>{\n                        return propConfig.options!.map(opt => (\n                            <ElOption label={opt.label} value={opt.val} />\n                        ))\n                    })()} */}\n                    {propConfig.options!.map(opt => (\n                        <ElOption label={opt.label} value={opt.val} />\n                    ))}\n                </ElSelect>),\n                [VisualEditorPropsType.table]: () => (\n                    <TablePropEditor\n                        v-model={state.editData.props[propName]}\n                        propConfig={propConfig}\n                    />\n                )\n            }[propConfig.type]();\n        }\n        return () => {\n            let content: JSX.Element[] = [];\n            if (!props.block) {\n                content.push(<>\n                    <ElFormItem label=\"容器宽度\">\n                        <ElInputNumber v-model={state.editData.width} {...{ step: 100 } as any} />\n                    </ElFormItem>\n                    <ElFormItem label=\"容器高度\">\n                        <ElInputNumber v-model={state.editData.height} {...{ step: 100 } as any} />\n                    </ElFormItem>\n                </>)\n            } else {\n                const { componentKey } = props.block;\n                const component = props.config.componentMap[componentKey];\n                content.push(<ElFormItem label=\"组件标识\">\n                    <ElInput v-model={state.editData.slotName}></ElInput>\n                </ElFormItem>);\n                if (!!component) {\n                    if (!!component.props) {\n                        content.push(<>\n                            {Object.entries(component.props || {}).map(([propName, propConfig]) => {\n                                return (<ElFormItem label={propConfig.label} key={propName}>\n                                    {renderEditor(propName, propConfig)}\n                                </ElFormItem>)\n                            })}\n                        </>)\n                    }\n                    if (!!component.model) {\n                        content.push(<>\n                            \b{Object.entries(component.model).map(([modelName, label]) => {\n                            return (<ElFormItem label={label}>\n                                <ElInput v-model={state.editData.model[modelName]} />\n                            </ElFormItem>)\n                        })}\n\n                        </>)\n                    }\n                }\n\n            }\n            return (\n                <div class=\"visual-editor-operator\">\n                    <ElForm labelPosition=\"top\">\n                        {content}\n                        <ElFormItem>\n                            <ElButton type=\"primary\" {...{ onClick: methods.apply } as any}>应用</ElButton>\n                            <ElButton {...{ onClick: methods.reset } as any}>重置</ElButton>\n                        </ElFormItem>\n                    </ElForm>\n                </div>\n            )\n        }\n    }\n})","import { computed, defineComponent, PropType, reactive, ref } from 'vue';\nimport { createEvent } from './plugins/event';\nimport { $$dialog } from './utils/dialog-service';\nimport { useModel } from './utils/useModel';\nimport { VisualEditorBlock } from './visual-editor-block';\nimport \"./visual-editor.scss\"\nimport { createNewBlock, VisualEditorBlockData, VisualEditorComponent, VisualEditorConfig, VisualEditorMarkLines, VisualEditorModelValue, VisualProvider } from './visual-editor.utils';\nimport { useVisualCommand } from './visual.command';\nimport { ElMessageBox } from 'element-plus'\nimport { $$dropdown, DropdownOption } from './utils/dropdown-service';\nimport { VisualOperatorEditor } from './visual-editor-operator'\n\n\n\nexport const VisualEditor = defineComponent({\n    props: {\n        modelValue: { type: Object as PropType<VisualEditorModelValue>, required: true },\n        config: { type: Object as PropType<VisualEditorConfig>, required: true },\n        formData: { type: Object as PropType<Record<string, any>>, required: true },\n        customProps: { type: Object as PropType<Record<string, any>> },\n    },\n    emits: {\n        'update:modelValue': (val?: VisualEditorModelValue) => true,\n    },\n    setup(props, ctx) {\n        /* 双向绑定至，容器中的组件数据 */\n        const dataModel = useModel(() => props.modelValue, val => ctx.emit('update:modelValue', val));\n\n        /* container结点对象的引用 */\n        const containerRef = ref({} as HTMLDivElement);\n\n        /* container节点的style样式对象 */\n        const containerStyle = computed(() => ({\n            width: `${dataModel.value.container.width}px`,\n            height: `${dataModel.value.container.height}px`,\n        }));\n\n        /* 计算选中与为选中的block状态 */\n        const focusData = computed(() => {\n            const focus: VisualEditorBlockData[] = [];\n            const unFocus: VisualEditorBlockData[] = [];\n            (dataModel.value.blocks || []).forEach(block => (block.focus ? focus : unFocus).push(block));\n            return {\n                focus,      // 此时选中的数据\n                unFocus     // 此时未选中的数据\n            }\n        })\n        const selectIndex = ref(-1);\n        const state = reactive({\n            selectBlock: computed(() => (dataModel.value.blocks || [])[selectIndex.value]),\n            preview: false,   // 当前是否正在编辑\n            // preview: true,\n            editing: true,       // 当前是否已经开启了编辑器\n        });\n\n        const classes = computed(() => [\n            'visual-editor',\n            {\n                'visual-editor-not-preview': !state.preview\n            }\n        ])\n\n        const dragstart = createEvent();\n        const dragend = createEvent();\n        VisualProvider.provide({dragstart,dragend});\n\n        /* 对外暴露的一些方法 */\n        const methods = {\n            clearFocus: (block?: VisualEditorBlockData) => {\n                let blocks = (dataModel.value.blocks || []);\n                if (blocks.length === 0) return;\n                if (!!block) {\n                    blocks = blocks.filter((item) => item != block);\n                }\n                blocks.forEach(block => block.focus = false);\n            },\n            updateBlocks: (blocks?: VisualEditorBlockData[]) => {\n                dataModel.value = { ...dataModel.value, blocks };\n            },\n            showBlockData: (block: VisualEditorBlockData) => {\n                $$dialog.textarea(JSON.stringify(block), \"节点数据\", { editReadonly: true });\n            },\n            importBlockData: async (block: VisualEditorBlockData) => {\n                const text = await $$dialog.textarea('', '请输入JSON字符串');\n                try {\n                    const data = JSON.parse(text || '');\n                    commander.updateBlock(data, block);\n                } catch (error) {\n                    console.error(error);\n                    ElMessageBox.alert('解析JSON字符串出错');\n                }\n            },\n            openEdit: () => {\n                state.editing = true;\n            }\n        }\n\n        /* 处理从菜单拖拽组件到容器的相关动作 */\n        const menuDragier = (() => {\n            let component = null as null | VisualEditorComponent;\n            const containerHandler = {\n                /** 拖拽菜单组件，进入容器时，设置鼠标为可放置状态*/\n                dragenter: (e: DragEvent) => { e.dataTransfer!.dropEffect = 'move'; },\n                /** 拖拽菜单组件，鼠标在容器中运动时，禁用默认事件 */\n                dragover: (e: DragEvent) => { e.preventDefault(); },\n                /** 如果拖拽过程中，鼠标离开了容器，设置鼠标为不可放置状态*/\n                dragleave: (e: DragEvent) => { e.dataTransfer!.dropEffect = 'none'; },\n                /** 组件在容器中放置时，通过事件对象的offsetX 和 offsetY 添加一条组件数据*/\n                drop: (e: DragEvent) => {\n                    const blocks = [...dataModel.value.blocks || []];\n                    blocks.push(createNewBlock({\n                        component: component!,\n                        top: e.offsetY,\n                        left: e.offsetX\n                    }));\n                    methods.updateBlocks(blocks);\n                    dragend.emit();\n                },\n            }\n            const blockHandler = {\n                /**\n                 * 处理拖拽菜单组件的开始动作\n                 * @param e \n                 * @param current \n                 */\n                dragstart: (e: DragEvent, current: VisualEditorComponent) => {\n                    containerRef.value.addEventListener('dragenter', containerHandler.dragenter);\n                    containerRef.value.addEventListener('dragover', containerHandler.dragover);\n                    containerRef.value.addEventListener('dragleave', containerHandler.dragleave);\n                    containerRef.value.addEventListener('drop', containerHandler.drop);\n                    component = current;\n                    dragstart.emit();\n                },\n                /**\n                 * 处理拖拽菜单组件的结束动作\n                 */\n                dragend: () => {\n                    containerRef.value.removeEventListener('dragenter', containerHandler.dragenter);\n                    containerRef.value.removeEventListener('dragover', containerHandler.dragover);\n                    containerRef.value.removeEventListener('dragleave', containerHandler.dragleave);\n                    containerRef.value.removeEventListener('drop', containerHandler.drop);\n                    component = null;\n                },\n            }\n\n            return blockHandler;\n        })();\n\n        /* 处理block选中的相关动作 */\n        const focusHandler = (() => {\n            return {\n                container: {\n                    onMousedown: (e: MouseEvent) => {\n                        if (state.preview) return;\n                        /* 此行导致报错：Uncaught TypeError: Cannot read property 'target' of undefined\n                            因为element-ui有代码在冒泡阶段，监听全局点击事件 阻止冒泡 不能获取e.target 报错\n                        */\n                        // e.stopPropagation();\n                        e.preventDefault();\n                        // 只处理点击的容器的事件，不处理点击元素的事件 如点击按钮的文本就不处理 只有点击边框才会处理\n                        if (e.currentTarget !== e.target) return;\n                        if (!e.shiftKey) {\n                            /* 点击空白处，清空所有选中的block */\n                            methods.clearFocus();\n                            selectIndex.value = -1;\n                        }\n                    }\n                },\n                block: {\n                    onMousedown: (e: MouseEvent, block: VisualEditorBlockData, index: number) => {\n                        if (state.preview) return;\n                        /* 此行导致报错：Uncaught TypeError: Cannot read property 'target' of undefined\n                            因为element-ui有代码在冒泡阶段，监听全局点击事件 阻止冒泡 不能获取e.target 报错\n                        */\n                        // e.stopPropagation();\n                        // e.preventDefault();\n                        if (e.shiftKey) {\n                            /* 按住了shift键，如果此时没有选中的block，就选中这个block，否则就令这个block的选中状态取反 */\n                            if (focusData.value.focus.length <= 1) {\n                                block.focus = true;\n                            } else {\n                                block.focus = !block.focus;\n                            }\n                        } else {\n                            /* 如果点击的这个block没有被选中，才清空其他被选中的block，否则不做任何处理。防止拖动多个block，取消其他block的选中状态 */\n                            if (!block.focus) {\n                                block.focus = true;\n                                methods.clearFocus(block);\n                            }\n                        }\n                        selectIndex.value = index\n                        blockDraggier.mousedown(e);\n                    }\n                }\n            }\n        })();\n\n        /* 处理block在container中拖拽移动的相关动作 */\n        const blockDraggier = (() => {\n            const mark = reactive({\n                x: null as null | number,\n                y: null as null | number\n            })\n\n            let dragState = {\n                startX: 0,\n                startY: 0,\n                startLeft: 0,\n                startTop: 0,\n                startPos: [] as { left: number; top: number }[],\n                dragging: false,\n                markLines: {} as VisualEditorMarkLines\n            }\n\n            const mousemove = (e: MouseEvent) => {\n                if (!dragState.dragging) {\n                    dragState.dragging = true;\n                    dragstart.emit();\n                }\n                let { clientX: moveX, clientY: moveY } = e;\n                let { startX, startY } = dragState;\n\n                // 按住shift键，只能横向或纵向移动\n                if (e.shiftKey) {\n                    if (Math.abs(moveX - startX) > Math.abs(moveY - startY)) {\n                        moveY = startY;\n                    } else {\n                        moveX = startX;\n                    }\n                }\n                const currentLeft = dragState.startLeft + moveX - startX;\n                const currentTop = dragState.startTop + moveY - startY;\n                const currentMark = {\n                    x: null as null | number,\n                    y: null as null | number\n                }\n                for (let i = 0; i < dragState.markLines.y.length; i++) {\n                    const { top, showTop } = dragState.markLines.y[i];\n                    if (Math.abs(top - currentTop) < 5) {\n                        moveY = top + startY - dragState.startTop;\n                        currentMark.y = showTop;\n                        break;\n                    }\n                }\n                for (let i = 0; i < dragState.markLines.x.length; i++) {\n                    const { left, showLeft } = dragState.markLines.x[i];\n                    if (Math.abs(left - currentLeft) < 5) {\n                        moveX = left + startX - dragState.startLeft;\n                        currentMark.x = showLeft;\n                        break;\n                    }\n                }\n                mark.x = currentMark.x;\n                mark.y = currentMark.y;\n\n                const durX = moveX - startX;\n                const durY = moveY - startY;\n                focusData.value.focus.forEach((block, index) => {\n                    block.top = dragState.startPos[index].top + durY;\n                    block.left = dragState.startPos[index].left + durX;\n                })\n            }\n            const mouseup = (e: MouseEvent) => {\n                document.removeEventListener('mousemove', mousemove);\n                document.removeEventListener('mouseup', mouseup);\n                mark.x = null;\n                mark.y = null;\n                if (dragState.dragging) {\n                    dragend.emit();\n                }\n            }\n\n            const mousedown = (e: MouseEvent) => {\n                dragState = {\n                    startX: e.clientX,\n                    startY: e.clientY,\n                    startLeft: state.selectBlock!.left,\n                    startTop: state.selectBlock!.top,\n                    startPos: focusData.value.focus.map(({ top, left }) => ({ top, left })),\n                    dragging: false,\n                    markLines: (() => {\n                        const { focus, unFocus } = focusData.value;\n                        const { top, left, width, height } = state.selectBlock!;\n                        let lines: VisualEditorMarkLines = { x: [], y: [] };\n                        [...unFocus, {\n                            top: 0,\n                            left: 0,\n                            width: dataModel.value.container.width,\n                            height: dataModel.value.container.height,\n                        }].forEach((block) => {\n                            const { top: t, left: l, width: w, height: h } = block;\n                            lines.y.push({ top: t, showTop: t });                               // 1.顶部对齐顶部\n                            lines.y.push({ top: t + h, showTop: t + h });                       // 2.顶部对齐底部\n                            lines.y.push({ top: t + h / 2 - height / 2, showTop: t + h / 2 });    // 3.中间对齐中间 垂直\n                            lines.y.push({ top: t - height, showTop: t });                      // 4.底部对齐顶部\n                            lines.y.push({ top: t + h - height, showTop: t + h });               // 5.底部对齐底部\n\n                            lines.x.push({ left: l, showLeft: l });                               // 1.左边对齐左边\n                            lines.x.push({ left: l + w, showLeft: l + w });                       // 2.左边对齐右边\n                            lines.x.push({ left: l + w / 2 - width / 2, showLeft: l + w / 2 });    // 3.中间对齐中间 水平\n                            lines.x.push({ left: l - width, showLeft: l });                      // 4.右边对齐左边\n                            lines.x.push({ left: l + w - width, showLeft: l + w });               // 5.右边对齐右边\n                        })\n                        return lines;\n                    })()\n                }\n                document.addEventListener('mousemove', mousemove);\n                document.addEventListener('mouseup', mouseup);\n            }\n            return {\n                mark,\n                mousedown\n            };\n        })();\n\n        /* 其他的一些事件 */\n        const handler = {\n            onContextmenuBlock: (e: MouseEvent, block: VisualEditorBlockData) => {\n                if (state.preview) return;\n                e.preventDefault();\n                e.stopPropagation();\n                $$dropdown({\n                    reference: e,\n                    content: () => <>\n                        <DropdownOption label=\"置顶节点\" icon=\"icon-place-top\" {...{ onClick: commander.placeTop }} />\n                        <DropdownOption label=\"置底节点\" icon=\"icon-place-bottom\" {...{ onClick: commander.placeBottom }} />\n                        <DropdownOption label=\"删除节点\" icon=\"icon-delete\" {...{ onClick: commander.delete }} />\n                        <DropdownOption label=\"查看数据\" icon=\"icon-browse\" {...{ onClick: () => { methods.showBlockData(block) } }} />\n                        <DropdownOption label=\"导入节点\" icon=\"icon-import\" {...{ onClick: () => { methods.importBlockData(block) } }} />\n                    </>\n                })\n            }\n        }\n        const commander = useVisualCommand({\n            focusData,\n            updateBlocks: methods.updateBlocks,\n            dataModel,\n            dragstart,\n            dragend\n        });\n        const buttons = [\n            { label: '撤销', icon: 'icon-back', handler: commander.undo, tip: 'ctrl+z' },\n            { label: '重做', icon: 'icon-forward', handler: commander.redo, tip: 'ctrl+shift+z' },\n            {\n                label: () => state.preview ? '编辑' : '预览',\n                icon: () => state.preview ? 'icon-edit' : 'icon-browse',\n                handler: () => {\n                    if (!state.preview) { methods.clearFocus() }\n                    state.preview = !state.preview;\n                }\n            },\n            {\n                label: '导入', icon: 'icon-import', handler: async () => {\n                    const text = await $$dialog.textarea('', '请输入导入的JSON字符串');\n                    try {\n                        const data = JSON.parse(text || '');\n                        dataModel.value = data;\n                    } catch (error) {\n                        console.error(error);\n                        ElMessageBox.alert('解析JSON字符串出错');\n                    }\n                }\n            },\n            {\n                label: '导出',\n                icon: 'icon-export',\n                handler: async () => {\n                    const text = $$dialog.textarea(JSON.stringify(dataModel.value), '导出的JSON数据', { editReadonly: true });\n                    console.log(\"text:\", text);\n\n                }\n            },\n            { label: '置顶', icon: 'icon-place-top', handler: () => { commander.placeTop() }, tip: 'ctrl+up' },\n            { label: '置底', icon: 'icon-place-bottom', handler: () => { commander.placeBottom() }, tip: 'ctrl+down' },\n            { label: '删除', icon: 'icon-delete', handler: () => { commander.delete() }, tip: 'ctrl+d,backspace,delete' },\n            { label: '清空', icon: 'icon-reset', handler: () => { commander.clear() } },\n            {\n                label: '关闭', icon: 'icon-close', handler: () => {\n                    methods.clearFocus();\n                    state.editing = false;\n                }\n            }\n        ]\n\n        return () => <>\n            <div class=\"visual-editor-container\" style={containerStyle.value}>\n                {!!dataModel.value.blocks && (\n                    dataModel.value.blocks.map((block, index) => (\n                        <VisualEditorBlock\n                            config={props.config}\n                            block={block}\n                            key={index}\n                            formData={props.formData}\n                            slots={ctx.slots}\n                            customProps={props.customProps}\n                        />\n                    ))\n                )}\n                <div class=\"vue-visual-container-edit-button\" onClick={methods.openEdit}>\n                    <i class=\"iconfont icon-edit\"></i>\n                    <span>编辑组件</span>\n                </div>\n            </div>\n            <div class={classes.value} v-show={state.editing}>\n                <div class=\"visual-editor-menu\">\n                    {props.config.componentList.map(component => (\n                        <div class=\"visual-editor-menu-item\"\n                            draggable\n                            onDragend={menuDragier.dragend}\n                            onDragstart={(e) => menuDragier.dragstart(e, component)}>\n                            <span class=\"visual-editor-menu-item-label\">{component.label}</span>\n                            <div class=\"visual-editor-menu-item-content\">\n                                {component.preview()}\n                            </div>\n                        </div>))}\n                </div>\n                <div class=\"visual-editor-head\">\n                    {\n                        buttons.map((btn, index) => {\n                            const label = typeof btn.label === \"function\" ? btn.label() : btn.label\n                            const icon = typeof btn.icon === \"function\" ? btn.icon() : btn.icon\n                            const content = (<div key={index} class=\"visual-editor-head-button\" onClick={btn.handler}>\n                                <i class={`iconfont ${icon}`}></i>\n                                <span>{label}</span>\n                            </div>);\n\n                            return !btn.tip ? content : <el-tooltip effect=\"dark\" content={btn.tip} placement=\"bottom\">\n                                {content}\n                            </el-tooltip>\n                        })\n                    }\n                </div>\n                <VisualOperatorEditor\n                    block={state.selectBlock}\n                    config={props.config}\n                    dataModel={dataModel}\n                    updateBlock={commander.updateBlock}\n                    updateModelValue={commander.updateModelValue}\n                />\n                <div class=\"visual-editor-body\">\n                    <div class=\"visual-editor-content\">\n                        <div class=\"visual-editor-container\"\n                            style={containerStyle.value}\n                            ref={containerRef}\n                            {...focusHandler.container}\n                        >\n                            {!!dataModel.value.blocks && (\n                                dataModel.value.blocks.map((block, index) => (\n                                    <VisualEditorBlock\n                                        config={props.config}\n                                        block={block}\n                                        key={index}\n                                        formData={props.formData}\n                                        slots={ctx.slots}\n                                        customProps={props.customProps}\n                                        {\n                                        ...{\n                                            onMousedown: (e: MouseEvent) => focusHandler.block.onMousedown(e, block, index),\n                                            onContextmenu: (e: MouseEvent) => handler.onContextmenuBlock(e, block)\n                                        }\n                                        }\n                                    />\n                                ))\n                            )}\n                            {blockDraggier.mark.y !== null && (\n                                <div class=\"visual-editor-mark-line-y\" style={{ top: `${blockDraggier.mark.y}px` }}></div>\n                            )}\n                            {blockDraggier.mark.x !== null && (\n                                <div class=\"visual-editor-mark-line-x\" style={{ left: `${blockDraggier.mark.x}px` }}></div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </>\n    }\n});","import { useModel } from \"@/packages/utils/useModel\";\nimport { defineComponent } from \"vue\";\nimport \"./number-range.scss\"\nexport const NumberRange = defineComponent({\n    props: {\n        start: { type: String },\n        end: { type: String }\n    },\n    emits: {\n        'update:start': (val?: string) => true,\n        'update:end': (val?: string) => true,\n    },\n    setup(props, ctx) {\n        const startModel = useModel(() => props.start, (val) => ctx.emit('update:start', val));\n        const endModel = useModel(() => props.end, (val) => ctx.emit('update:end', val));\n\n        return () => (\n            <div class=\"number-range\">\n                <div><input type=\"text\" v-model={startModel.value} /></div>\n                <span>~</span>\n                <div><input type=\"text\" v-model={endModel.value} /></div>\n            </div>\n        )\n    }\n})","import { createVisualEditorConfig } from \"./packages/visual-editor.utils\";\nimport { ElButton, ElInput, ElOption, ElSelect } from 'element-plus';\nimport { VisualEditorProps, VisualEditorPropsType } from \"./packages/visual-editor.props\";\nimport { NumberRange } from \"./packages/components/number-range/number-range\";\nexport const visualConfig = createVisualEditorConfig();\nimport \"./visual.config.scss\"\n\nvisualConfig.registry('text', {\n    label: '文本',\n    preview: () => '预览文本',\n    render: ({ props }) => <span style={{ color: props.color, fontSize: props.size }}>{props.text || '默认文本'}</span>,\n    props: {\n        text: createEditorInputProp('显示文本'),\n        color: createEditorColorProp('字体颜色'),\n        size: createEditorSelectProp('字体大小', [\n            { label: '14px', val: '14px' },\n            { label: '18px', val: '18px' },\n            { label: '24px', val: '24px' },\n        ])\n    }\n})\n\nvisualConfig.registry('button', {\n    label: '按钮',\n    preview: () => <ElButton>按钮</ElButton>,\n    render: ({ props, size, custom }) => (\n        <ElButton\n            {...custom}\n            type={props.type}\n            size={props.size}\n            style={{\n                /* 这样写是因为拖拽调整宽高，不能撤销到初始状态，\n                即第一次拖拽的数据虽然更新了，但视图没更新 */\n                width: !!size.height ? `${size.width}px` : null, \n                height: !!size.height ? `${size.height}px` : null\n            }}>\n            {props.text || '按钮'}\n        </ElButton>\n    ),\n    resize: { width: true, height: true },\n    props: {\n        text: createEditorInputProp('显示文本'),\n        color: createEditorColorProp('字体颜色'),\n        type: createEditorSelectProp('按钮类型', [\n            { label: '基础', val: 'primary' },\n            { label: '成功', val: 'success' },\n            { label: '警告', val: 'warning' },\n            { label: '危险', val: 'danger' },\n            { label: '提示', val: 'danger' },\n            { label: '文本', val: 'text' },\n        ]),\n        size: createEditorSelectProp('按钮大小', [\n            { label: '默认', val: '' },\n            { label: '中等', val: 'medium' },\n            { label: '小', val: 'small' },\n            { label: '极小', val: 'mini' },\n        ])\n    }\n})\n\nvisualConfig.registry('select', {\n    label: '下拉框',\n    preview: () => <ElSelect />,\n    render: ({ props, model, custom }) => (\n        <ElSelect {...custom} key={(props.options || []).map((opt: any) => opt.value).join(',')} {...model.default}>\n            {(props.options || []).map((opt: { label: string; value: string }, index: string) => {\n                return (<ElOption label={opt.label} value={opt.value} key={index} />)\n            })}\n        </ElSelect>\n    ),\n    props: {\n        options: createEditorTableProp('下拉选项', {\n            options: [\n                { label: '显示值', field: 'label' },\n                { label: '绑定值', field: 'value' },\n                { label: '备注', field: 'comments' },\n            ],\n            showKey: 'label'\n        })\n    },\n    model: {\n        default: '绑定字段'\n    }\n})\n\nvisualConfig.registry('input', {\n    label: '输入框',\n    preview: () => <ElInput modelValue={\"\"} />,\n    render: ({ model, size, custom }) => {\n        return (<ElInput {...custom} {...model.default} style={{ \n            width: !!size.height ? `${size.width}px` : null,\n        }} />)\n    },\n    resize: { width: true },\n    model: {\n        default: '绑定字段'\n    }\n})\n\nvisualConfig.registry('number-range', {\n    label: \"数字范围输入框\",\n    resize: { width: true },\n    preview: () => <NumberRange style={{ \n        width: '100%' \n    }} />,\n    render: ({ model, size }) => <NumberRange\n        style={{ \n            width: !!size.height ? `${size.width}px` : null,\n        }}\n        {...{\n            start: model.start.value,\n            'onUpdate:start': model.start.onChange,\n            end: model.end.value,\n            'onUpdate:end': model.end.onChange,\n        }}\n    />,\n    model: {\n        start: \"起始绑定字段\",\n        end: \"结束绑定字段\"\n    }\n\n})\n\nvisualConfig.registry('image', {\n    label: \"图片\",\n    resize: { width: true, height: true },\n    props: {\n        url: createEditorInputProp('地址')\n    },\n    render: ({ props, size }) => {\n        return (\n            <div style={{ height: `${size.height || 100}px`, width: `${size.width || 100}px` }} class=\"visual-block-image\">\n                <img src={props.url || 'https://avatars.githubusercontent.com/u/23214721?s=400&u=525efab9f8487c891ab07a9f5d308e1a7a8f0097&v=4'} />\n            </div>\n        )\n    },\n    preview: () => {\n        return (\n            <div style=\"text-align:center;\">\n                <div style=\"font-size:20px;background-color:#f2f2f2;color:#ccc;display:inline-flex;width:100px;height:50px\">\n                    <i class=\"el-icon-picture\"></i>\n                </div>\n            </div>\n        )\n    }\n})\n\n\n// input\nexport function createEditorInputProp(label: string): VisualEditorProps {\n    return {\n        type: VisualEditorPropsType.input,\n        label,\n    }\n}\n\n// color\nexport function createEditorColorProp(label: string): VisualEditorProps {\n    return {\n        type: VisualEditorPropsType.color,\n        label,\n    }\n}\n\n// select\nexport type VisualEditorSelectOptions = {\n    label: string;\n    val: string;\n}[]\n\nexport function createEditorSelectProp(label: string, options: VisualEditorSelectOptions): VisualEditorProps {\n    return {\n        type: VisualEditorPropsType.select,\n        label,\n        options,\n    }\n}\n\n// table\nexport type VisualEditorTableOption = {\n    options: {\n        label: string;   // 列显示文本\n        field: string;   // 列绑定字段\n    }[];\n    showKey: string;\n}\n\nexport function createEditorTableProp(label: string, option: VisualEditorTableOption): VisualEditorProps {\n    return {\n        type: VisualEditorPropsType.table,\n        label,\n        table: option,\n    }\n}","import { render } from \"./App.vue?vue&type=template&id=05e93430\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=05e93430&lang=scss\"\nscript.render = render\n\nexport default script","import { createApp } from 'vue'\nimport App from './App.vue'\nimport ElementPlus from 'element-plus'\nimport 'element-plus/lib/theme-chalk/index.css'\n\nconst app = createApp(App);\napp.use(ElementPlus);\napp.mount('#app')\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=0&id=05e93430&lang=scss\""],"sourceRoot":""}